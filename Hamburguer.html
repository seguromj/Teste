
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BeeDrinks - Card√°pio Digital</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --primary: #FFD700; --dark: #1a1a1a; --light: #fff; --gray: #f8f9fa; --danger: #ff4d4d; --success: #27ae60; --shadow: 0 4px 15px rgba(0,0,0,0.1); }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background-color: var(--gray); color: var(--dark); }
        
        /* CABE√áALHO DA IMAGEM */
        header { 
            position: relative; 
            height: 250px; 
            background: url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSqbGX3sgziiqs-2IZgbXwe16HgImo4ztWdcVkG9OqxJQ&s=10') center/cover no-repeat;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 60px;
            border-bottom-left-radius: 30px;
            border-bottom-right-radius: 30px;
        }
        header h1 {
            color: white;
            font-size: 3em;
            text-shadow: 2px 2px 10px rgba(0,0,0,0.8);
            z-index: 1;
            margin: 0;
        }
        .profile-img-container {
            position: absolute;
            bottom: -50px;
            background: white;
            padding: 5px;
            border-radius: 50%;
            box-shadow: var(--shadow);
            z-index: 2;
        }
        .profile-img { width: 100px; height: 100px; border-radius: 50%; object-fit: contain; }

        .container { max-width: 1000px; margin: 0 auto; padding: 20px; padding-bottom: 120px; text-align: center;}
        
        .store-info { display: flex; flex-direction: column; align-items: center; gap: 8px; margin-bottom: 20px; font-size: 1.1em; font-weight: 500;}
        .status-badge { display: flex; align-items: center; gap: 8px; font-weight: bold; }
        
        /* ANIMA√á√ÉO PONTO VERDE */
        .dot { height: 12px; width: 12px; border-radius: 50%; display: inline-block; }
        .dot-open { 
            background-color: var(--success); 
            box-shadow: 0 0 0 rgba(39, 174, 96, 0.4);
            animation: pulse-vibrate 1.5s infinite;
        }
        .dot-closed { background-color: var(--danger); }

        @keyframes pulse-vibrate {
            0% { transform: scale(0.95) translate(0, 0); box-shadow: 0 0 0 0 rgba(39, 174, 96, 0.7); }
            10% { transform: scale(1) translate(-1px, 1px); }
            20% { transform: scale(1) translate(1px, -1px); }
            70% { transform: scale(1.1) translate(0, 0); box-shadow: 0 0 0 10px rgba(39, 174, 96, 0); }
            100% { transform: scale(0.95) translate(0, 0); box-shadow: 0 0 0 0 rgba(39, 174, 96, 0); }
        }

        .insta-link { color: #e1306c; text-decoration: none; font-weight: bold; }

        /* RESTANTE DO ESTILO ORIGINAL */
        .categories { display: flex; gap: 10px; overflow-x: auto; padding: 10px 0; margin-bottom: 20px; scrollbar-width: none; justify-content: center;}
        .category-btn { padding: 10px 25px; border-radius: 25px; border: 1px solid #ddd; background: white; cursor: pointer; white-space: nowrap; font-weight: 600; }
        .category-btn.active { background: var(--primary); border-color: var(--primary); }

        h2 { border-left: 5px solid var(--primary); padding-left: 10px; margin-top: 30px; text-align: left;}
        
        /* CARROSSEL */
        .carousel-container { 
            display: flex; 
            overflow-x: auto; 
            gap: 15px; 
            padding: 10px 5px; 
            scrollbar-width: none; 
            cursor: grab;
            user-select: none;
        }
        .carousel-container:active { cursor: grabbing; }
        .carousel-container::-webkit-scrollbar { display: none; }

        .product-card { background: white; min-width: 250px; border-radius: 15px; padding: 15px; box-shadow: var(--shadow); flex-shrink: 0; text-align: center; pointer-events: auto;}
        .product-card img { width: 100%; height: 150px; object-fit: cover; border-radius: 10px; pointer-events: none; }
        
        .price { color: var(--success); font-weight: bold; font-size: 1.2em; display: block; margin: 10px 0; }
        .btn-main, .btn-add { background: var(--primary); border: none; width: 100%; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: bold; }
        .btn-flavor { background: var(--dark); color: var(--primary); }

        /* MODAIS E CARRINHO */
        .cart-footer { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 500px; background: var(--dark); color: white; padding: 15px; border-radius: 20px; display: none; justify-content: space-between; align-items: center; z-index: 999; }
        #cart-modal, #checkout-modal, #payment-modal, #flavor-modal { display: none; position: fixed; bottom: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; }
        .modal-content { position: absolute; bottom: 0; background: white; width: 100%; border-top-left-radius: 30px; border-top-right-radius: 30px; padding: 25px; box-sizing: border-box; max-height: 90vh; overflow-y: auto; }
        
        /* BOT√ÉO VOLTAR NOS MODAIS */
        .modal-header { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; }
        .btn-back { background: none; border: none; font-size: 1.5em; cursor: pointer; color: var(--dark); }

        .cart-row { display: flex; align-items: center; gap: 10px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .cart-img { width: 50px; height: 50px; border-radius: 8px; object-fit: cover; }
        .qty-controls { display: flex; align-items: center; gap: 10px; background: #eee; padding: 5px 10px; border-radius: 8px; }
        .btn-remove { background: none; border: none; color: var(--danger); cursor: pointer; font-size: 1.2em; padding: 5px; }

        .form-group { margin-bottom: 15px; text-align: left; }
        input, select { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; }
        .flavor-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .flavor-btn { padding: 15px; border: 1px solid #ddd; border-radius: 10px; background: #f9f9f9; cursor: pointer; }
        
        /* Alerta de erro para CPF */
        .input-error { border-color: var(--danger) !important; background-color: #fff0f0; }

        /* Estilos de Cupom e Avisos */
        .coupon-area { margin: 15px 0; display: flex; gap: 10px; }
        .coupon-area input { flex: 1; }
        .btn-apply { background: var(--dark); color: white; border: none; border-radius: 8px; padding: 0 15px; cursor: pointer; }
        .delivery-warning { background: #fff3cd; color: #856404; padding: 10px; border-radius: 8px; margin-top: 10px; font-size: 0.9em; display: none; border: 1px solid #ffeeba; }
    </style>
</head>
<body>

<header>
    <h1>Hamb√∫rgue</h1>
    <div class="profile-img-container">
        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRrTmHVjCcRlcqqF2asUVplZEAR334n72H5vbI4cck6rQFV2LbOOS0q0c8V&s=10" alt="Logo" class="profile-img">
    </div>
</header>

<div class="container">
    <div class="store-info">
        <span><i class="fas fa-map-marker-alt"></i> Nossa localiza√ß√£o - An√°polis</span>
        <div id="store-status" class="status-badge"></div>
        <a href="https://instagram.com" target="_blank" class="insta-link"><i class="fab fa-instagram"></i> @Seu_insta</a>
    </div>

    <div class="categories">
        <button class="category-btn active" onclick="filterCategory('all')">Todos</button>
        <button class="category-btn" onclick="filterCategory('alcool')">Drinks com √Ålcool</button>
        <button class="category-btn" onclick="filterCategory('sem-alcool')">Sem √Ålcool</button>
        <button class="category-btn" onclick="filterCategory('copao')">Cop√£o</button>
        <button class="category-btn" onclick="filterCategory('combo')">Combos</button>
    </div>

    <div id="menu-sections">
        <div class="menu-section" data-category="alcool">
            <h2>Drinks com √Ålcool</h2>
            <div class="carousel-container drag-scroll">
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1514362545857-3bc16c4c7d1b?w=300">
                    <h3>Gin Especial</h3><span class="price">R$ 25.00</span>
                    <button class="btn-add btn-flavor" onclick="openFlavorModal('Gin Especial', 25.00, ['Tradicional', 'Morango', 'Tropical', 'Melancia'], 'https://images.unsplash.com/photo-1514362545857-3bc16c4c7d1b?w=300')">Escolher Sabor</button>
                </div>
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1551024709-8f23befc6f87?w=300">
                    <h3>Caipirinha VIP</h3><span class="price">R$ 20.00</span>
                    <button class="btn-add btn-flavor" onclick="openFlavorModal('Caipirinha VIP', 20.00, ['Lim√£o', 'Morango', 'Kiwi', 'Abacaxi'], 'https://images.unsplash.com/photo-1551024709-8f23befc6f87?w=300')">Escolher Fruta</button>
                </div>
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1536935338788-846bb9981813?w=300">
                    <h3>Mojito Fusion</h3><span class="price">R$ 22.00</span>
                    <button class="btn-add btn-flavor" onclick="openFlavorModal('Mojito Fusion', 22.00, ['Menta', 'Morango', 'Amora', 'Classic'], 'https://images.unsplash.com/photo-1536935338788-846bb9981813?w=300')">Escolher Sabor</button>
                </div>
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1541301623028-99b262a80613?w=300">
                    <h3>Cerveja Long Neck</h3><span class="price">R$ 12.00</span>
                    <button class="btn-add" onclick="addToCart('Cerveja Long Neck', 12.00, 'https://images.unsplash.com/photo-1541301623028-99b262a80613?w=300')">Adicionar</button>
                </div>
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1470337458703-46ad1756a187?w=300">
                    <h3>Martini Cl√°ssico</h3><span class="price">R$ 28.00</span>
                    <button class="btn-add" onclick="addToCart('Martini Cl√°ssico', 28.00, 'https://images.unsplash.com/photo-1470337458703-46ad1756a187?w=300')">Adicionar</button>
                </div>
            </div>
        </div>

        <div class="menu-section" data-category="sem-alcool">
            <h2>Drinks sem √Ålcool</h2>
            <div class="carousel-container drag-scroll">
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1543648964-1402c5553d65?w=300">
                    <h3>Soda Italiana</h3><span class="price">R$ 15.00</span>
                    <button class="btn-add btn-flavor" onclick="openFlavorModal('Soda Italiana', 15.00, ['Ma√ß√£ Verde', 'Cereja', 'P√™ssego', 'Cura√ßau'], 'https://images.unsplash.com/photo-1543648964-1402c5553d65?w=300')">Escolher Sabor</button>
                </div>
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1624517452488-04869289c4ca?w=300">
                    <h3>Milkshake</h3><span class="price">R$ 18.00</span>
                    <button class="btn-add btn-flavor" onclick="openFlavorModal('Milkshake', 18.00, ['Chocolate', 'Morango', 'Baunilha', 'Oreo'], 'https://images.unsplash.com/photo-1624517452488-04869289c4ca?w=300')">Escolher Sabor</button>
                </div>
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1513558161293-cdaf765ed2fd?w=300">
                    <h3>Suco Natural</h3><span class="price">R$ 10.00</span>
                    <button class="btn-add btn-flavor" onclick="openFlavorModal('Suco Natural', 10.00, ['Laranja', 'Abacaxi', 'Uva', 'Acerola'], 'https://images.unsplash.com/photo-1513558161293-cdaf765ed2fd?w=300')">Escolher Fruta</button>
                </div>
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1556881286-fc6915169721?w=300">
                    <h3>√Ågua Mineral</h3><span class="price">R$ 5.00</span>
                    <button class="btn-add" onclick="addToCart('√Ågua Mineral', 5.00, 'https://images.unsplash.com/photo-1556881286-fc6915169721?w=300')">Adicionar</button>
                </div>
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1622483767028-3f66f32aef97?w=300">
                    <h3>Coca-Cola Lata</h3><span class="price">R$ 7.00</span>
                    <button class="btn-add" onclick="addToCart('Coca-Cola Lata', 7.00, 'https://images.unsplash.com/photo-1622483767028-3f66f32aef97?w=300')">Adicionar</button>
                </div>
            </div>
        </div>

        <div class="menu-section" data-category="copao">
            <h2>Cop√£o</h2>
            <div class="carousel-container drag-scroll">
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1556679343-c7306c1976bc?w=300">
                    <h3>Cop√£o Whisky</h3><span class="price">R$ 30.00</span>
                    <button class="btn-add btn-flavor" onclick="openFlavorModal('Cop√£o Whisky', 30.00, ['Red Label', 'Jack Daniels', 'Ballantines', 'Passport'], 'https://images.unsplash.com/photo-1556679343-c7306c1976bc?w=300')">Escolher Whisky</button>
                </div>
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1595981267035-7b04ca84a82d?w=300">
                    <h3>Cop√£o de Gin</h3><span class="price">R$ 28.00</span>
                    <button class="btn-add btn-flavor" onclick="openFlavorModal('Cop√£o Gin', 28.00, ['Tropical', 'Melancia', 'Morango', 'Ma√ß√£ Verde'], 'https://images.unsplash.com/photo-1595981267035-7b04ca84a82d?w=300')">Escolher Sabor</button>
                </div>
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1560512823-829485b8bf24?w=300">
                    <h3>Cop√£o de Vodka</h3><span class="price">R$ 25.00</span>
                    <button class="btn-add btn-flavor" onclick="openFlavorModal('Cop√£o Vodka', 25.00, ['Energ√©tico', 'Suco Uva', 'Coco', 'Maracuj√°'], 'https://images.unsplash.com/photo-1560512823-829485b8bf24?w=300')">Escolher Mix</button>
                </div>
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1513558161293-cdaf765ed2fd?w=300">
                    <h3>Suco Laranja 700ml</h3><span class="price">R$ 15.00</span>
                    <button class="btn-add" onclick="addToCart('Suco Laranja 700ml', 15.00, 'https://images.unsplash.com/photo-1513558161293-cdaf765ed2fd?w=300')">Adicionar</button>
                </div>
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1622483767028-3f66f32aef97?w=300">
                    <h3>Refri 600ml</h3><span class="price">R$ 10.00</span>
                    <button class="btn-add" onclick="addToCart('Refri 600ml', 10.00, 'https://images.unsplash.com/photo-1622483767028-3f66f32aef97?w=300')">Adicionar</button>
                </div>
            </div>
        </div>

        <div class="menu-section" data-category="combo">
            <h2>Combos</h2>
            <div class="carousel-container drag-scroll">
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1597075095400-b2489955d49f?w=300">
                    <h3>Combo Destilado</h3><span class="price">R$ 100.00</span>
                    <button class="btn-add btn-flavor" onclick="openFlavorModal('Combo Destilado', 100.00, ['Vodka + 4 Energ', 'Gin + 4 Tonic', 'Whisky + 4 Energ', 'Vinho + Suco'], 'https://images.unsplash.com/photo-1597075095400-b2489955d49f?w=300')">Escolher Combo</button>
                </div>
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=300">
                    <h3>Combo Casal</h3><span class="price">R$ 50.00</span>
                    <button class="btn-add btn-flavor" onclick="openFlavorModal('Combo Casal', 50.00, ['2 Gins', '2 Caipirinhas', '2 Mojitos', '2 Sodas'], 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=300')">Escolher Bebidas</button>
                </div>
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1597075095400-b2489955d49f?w=300">
                    <h3>Combo Balde</h3><span class="price">R$ 80.00</span>
                    <button class="btn-add btn-flavor" onclick="openFlavorModal('Combo Balde', 80.00, ['6 Long Necks', '5 Cervejas + Por√ß√£o', '4 Drinks VIP', '10 Shots'], 'https://images.unsplash.com/photo-1597075095400-b2489955d49f?w=300')">Escolher Itens</button>
                </div>
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1597075095400-b2489955d49f?w=300">
                    <h3>Combo Amigos Fixo</h3><span class="price">R$ 100.00</span>
                    <button class="btn-add" onclick="addToCart('Combo Amigos Fixo', 100.00, 'https://images.unsplash.com/photo-1597075095400-b2489955d49f?w=300')">Adicionar</button>
                </div>
                <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1597075095400-b2489955d49f?w=300">
                    <h3>Combo Shot Galera</h3><span class="price">R$ 45.00</span>
                    <button class="btn-add" onclick="addToCart('Combo Shot Galera', 45.00, 'https://images.unsplash.com/photo-1597075095400-b2489955d49f?w=300')">Adicionar</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="cart-footer" class="cart-footer" onclick="toggleCart()">
    <div><i class="fas fa-shopping-basket"></i> <span id="cart-count">0</span> itens</div>
    <strong>R$ <span id="cart-total-display">0.00</span></strong>
</div>

<div id="flavor-modal">
    <div class="modal-content">
        <div class="modal-header">
            <button class="btn-back" onclick="closeModal('flavor-modal')"><i class="fas fa-arrow-left"></i></button>
            <h3 id="flavor-title" style="margin:0"></h3>
        </div>
        <div id="flavor-options" class="flavor-grid"></div>
        <button class="btn-main" style="background:#999; margin-top:15px" onclick="closeModal('flavor-modal')">Cancelar</button>
    </div>
</div>

<div id="cart-modal">
    <div class="modal-content">
        <div class="modal-header">
            <button class="btn-back" onclick="toggleCart()"><i class="fas fa-arrow-left"></i></button>
            <h2 style="margin:0">Sua Sacola</h2>
        </div>
        <div id="cart-items-list"></div>
        
        <div class="coupon-area">
            <input type="text" id="coupon-input" placeholder="Tem um cupom?">
            <button class="btn-apply" onclick="applyCoupon()">Aplicar</button>
        </div>
        <div id="coupon-msg" style="font-size: 0.8em; margin-bottom: 10px; text-align: left;"></div>

        <div style="margin-top:20px; font-weight:bold; font-size:1.2em">Total: R$ <span id="modal-total">0.00</span></div>
        <button class="btn-main" onclick="openCheckout()" style="margin-top:15px">Finalizar Compra</button>
        <button class="btn-main" style="background:#999; margin-top:10px" onclick="toggleCart()">Continuar Comprando</button>
    </div>
</div>

<div id="checkout-modal">
    <div class="modal-content">
        <div class="modal-header">
            <button class="btn-back" onclick="closeCheckout()"><i class="fas fa-arrow-left"></i></button>
            <h2 style="margin:0">Checkout</h2>
        </div>
        <div class="form-group">
            <label>Como deseja receber?</label>
            <select id="delivery-type" onchange="toggleFields()">
                <option value="mesa">Mesa 5</option>
                <option value="retirada">Retirar no Balc√£o</option>
                <option value="delivery">Delivery em Casa</option>
            </select>
            <div id="delivery-warning" class="delivery-warning">
                <i class="fas fa-exclamation-triangle"></i> Aten√ß√£o: Pedidos para delivery possuem um acr√©scimo de R$ 10,00 na taxa de entrega.
            </div>
        </div>
        <div id="fields-mesa"><div class="form-group"><label>Nome*</label><input type="text" id="mesa-nome"></div></div>
        <div id="fields-retirada" style="display:none"><div class="form-group"><label>Nome*</label><input type="text" id="ret-nome"></div><div class="form-group"><label>CPF*</label><input type="text" id="cpf-retirada" oninput="mascaraCPF(this)" maxlength="14"></div></div>
        <div id="fields-delivery" style="display:none">
            <div class="form-group"><label>Nome*</label><input type="text" id="dev-nome"></div>
            <div class="form-group"><label>CPF*</label><input type="text" id="dev-CPF" oninput="mascaraCPF(this)" maxlength="14"></div>
            <div class="form-group"><label>Bairro*</label><input type="text" id="dev-bairro"></div>
            <div class="form-group"><label>Rua*</label><input type="text" id="dev-rua"></div>
            <div class="form-group"><label>N¬∫/Lote*</label><input type="text" id="dev-num"></div>
            <div class="form-group"><label>Complemento</label><input type="text" id="dev-comp" placeholder="Apt, bloco, ponto de ref..."></div>
        </div>
        <button class="btn-main" onclick="sendWhatsApp()">Confirmar e Pagar</button>
    </div>
</div>

<div id="payment-modal">
       <div class="modal-content" style="text-align: center;">
           
        <i class="fas fa-shield-alt" style="font-size: 4em; color: var(--success); margin-bottom: 15px;"></i>
        <h2 style="margin:0 0 10px 0;">
        <button class="btn-back" onclick="closePayment()"><i class="fas fa-arrow-left"></i></button>
            Finalizar Pagamento</h2>
		<p style="color: #666; font-size: 0.9em;">Seu pedido j√° foi enviado para nossa cozinha!<br>Agora, realize o pagamento para finalizar.</p>
        
        <div style="background: #f8f9fa; padding: 20px; border-radius: 15px; margin: 20px 0;">
            <span style="font-size: 0.9em; color: #777;">Valor Total:</span><br>
            <strong style="font-size: 2em; color: var(--success);">R$ <span id="pay-total">0.00</span></strong>
        </div>

        <a id="pay-link" href="#" target="_blank" class="btn-main" style="display: block; text-decoration: none; background: #009ee3; margin-bottom: 10px;">
            Pagar Agora <i class="fas fa-lock"></i>
        </a>

        <button class="btn-main" onclick="finalizarWhatsApp()" style="background: #25D366;">
            Finalizar Compra / WhatsApp <i class="fab fa-whatsapp"></i>
        </button>
    </div>
</div>

<script>
    let cart = [];
    let currentFlavorProduct = null;
    let currentPaymentLink = "#"; 
    let activeDiscount = 0;
    let freeShippingRequested = false; // Indica se o usu√°rio digitou o cupom

    const linksDePagamentoFixos = {
        "1.00": "https://mpago.la/2AXmnns", "2.00": "https://mpago.la/1XRx3MU", "3.00": "https://mpago.la/2hCQdie",
        "4.00": "https://mpago.la/21V68Ki", "5.00": "https://mpago.la/2GCnr3j", "6.00": "https://mpago.la/127jvNn",
        "7.00": "https://mpago.la/2p6uptE", "8.00": "https://mpago.la/11j2Jua", "9.00": "https://mpago.la/1eFbxkN",
        "10.00": "https://mpago.la/2cRxjg5", "11.00": "https://mpago.la/2LS6XMT", "12.00": "https://mpago.la/1ssdztd",
        "13.00": "https://mpago.la/2pEQ3rJ", "14.00": "https://mpago.la/2ShtRu7", "15.00": "https://mpago.la/2MdLA1J",
        "16.00": "https://mpago.la/122M9xy", "17.00": "https://mpago.la/1hZpFv4", "18.00": "https://mpago.la/2cvpYLD",
        "19.00": "https://mpago.la/2fHzer1", "20.00": "https://mpago.la/2d4EhNH", "21.00": "https://mpago.la/2wtPbWJ",
        "22.00": "https://mpago.la/1VEbPD6", "23.00": "https://mpago.la/1u4N2eZ", "24.00": "https://mpago.la/2tz3Thg",
        "25.00": "https://mpago.la/24MoD81", "26.00": "https://mpago.la/1gQ85w8", "27.00": "https://mpago.la/2ncRJDR",
        "28.00": "https://mpago.la/1rHT6fQ", "29.00": "https://mpago.la/1wP8yiX", "30.00": "https://mpago.la/1wEbmXA",
        "31.00": "https://mpago.la/23tCjAH", "32.00": "https://mpago.la/1H7ACLr", "33.00": "https://mpago.la/2P1Snuu",
        "34.00": "https://mpago.la/2dM8pXF", "35.00": "https://mpago.la/2ccdL4T", "36.00": "https://mpago.la/2LUutRb",
        "37.00": "https://mpago.la/2SaBCdk", "38.00": "https://mpago.la/32a4XhN", "39.00": "https://mpago.la/1uK9SV6",
        "40.00": "https://mpago.la/22fHXUh", "41.00": "https://mpago.la/2FJM5SR", "42.00": "https://mpago.la/2majQ3e",
        "43.00": "https://mpago.la/2xuPWxe", "44.00": "https://mpago.la/1xnrgBU", "45.00": "https://mpago.la/2YxWyeN",
        "46.00": "https://mpago.la/1C8B2Ys", "47.00": "https://mpago.la/2BHbwKb", "48.00": "https://mpago.la/2wJ79yX",
        "49.00": "https://mpago.la/1q1CXu8", "50.00": "https://mpago.la/18PNJgh", "51.00": "https://mpago.la/29ngSEP",
        "52.00": "https://mpago.la/1wpPNU6", "53.00": "https://mpago.la/2w4JghY", "54.00": "https://mpago.la/2wP8Zzy",
        "55.00": "https://mpago.la/1uNDuE1", "56.00": "https://mpago.la/2HwcPeo", "57.00": "https://mpago.la/2SrqAtv",
        "58.00": "https://mpago.la/2QddsUQ", "59.00": "https://mpago.la/1KyezXR", "60.00": "https://mpago.la/32XUkFX",
        "61.00": "https://mpago.la/2LdRTmk", "62.00": "https://mpago.la/31yQrfo", "63.00": "https://mpago.la/2Nj6SQ3",
        "64.00": "https://mpago.la/1AUtYYJ", "65.00": "https://mpago.la/2dJLWg6", "66.00": "https://mpago.la/2Qq6ofn",
        "67.00": "https://mpago.la/2HSYSG8", "68.00": "https://mpago.la/2agtz9z", "69.00": "https://mpago.la/1yzPBDV",
        "70.00": "https://mpago.la/19j57aj", "71.00": "https://mpago.la/2NN176T", "72.00": "https://mpago.la/2bgb4hq",
        "73.00": "https://mpago.la/1Pjn7DD", "74.00": "https://mpago.la/1bnsqvS", "75.00": "https://mpago.la/1ScZwvW",
        "76.00": "https://mpago.la/2pF999n", "77.00": "https://mpago.la/25ZZdoS", "78.00": "https://mpago.la/1df8NXT",
        "79.00": "https://mpago.la/2c5ZvKh", "80.00": "https://mpago.la/2StD47t", "81.00": "https://mpago.la/1g2b3ky",
        "82.00": "https://mpago.la/1EQriMV", "83.00": "https://mpago.la/2Ur8gAJ", "84.00": "https://mpago.la/12trufq",
        "85.00": "https://mpago.la/2UkJGkF", "86.00": "https://mpago.la/1N2Zw5R", "87.00": "https://mpago.la/2QSwF7p",
        "88.00": "https://mpago.la/2CnEweW", "89.00": "https://mpago.la/1qjGyST", "90.00": "https://mpago.la/18ZpYMG",
        "91.00": "https://mpago.la/2jXbcve", "92.00": "https://mpago.la/1G4GRb4", "93.00": "https://mpago.la/1G4GRb4",
        "94.00": "https://mpago.la/2L5SfaX", "95.00": "https://mpago.la/1T8HvbD", "96.00": "https://mpago.la/16i17Um",
        "97.00": "https://mpago.la/2ULjkPj", "98.00": "https://mpago.la/2WWWm1m", "99.00": "https://mpago.la/2wQMxrn",
        "100.00": "https://mpago.la/14fLE5V",
    };

    window.onload = function() {
        const savedCart = localStorage.getItem('beeDrinksCart');
        if (savedCart) {
            cart = JSON.parse(savedCart);
            updateUI();
        }
        checkStoreStatus();
    };

    function saveCart() { localStorage.setItem('beeDrinksCart', JSON.stringify(cart)); }

    const sliders = document.querySelectorAll('.carousel-container');
    let isDown = false;
    let startX;
    let scrollLeft;

    sliders.forEach(slider => {
        slider.addEventListener('mousedown', (e) => {
            isDown = true;
            startX = e.pageX - slider.offsetLeft;
            scrollLeft = slider.scrollLeft;
        });
        slider.addEventListener('mouseleave', () => isDown = false);
        slider.addEventListener('mouseup', () => isDown = false);
        slider.addEventListener('mousemove', (e) => {
            if (!isDown) return;
            e.preventDefault();
            const x = e.pageX - slider.offsetLeft;
            const walk = (x - startX) * 2;
            slider.scrollLeft = scrollLeft - walk;
        });
    });

    function checkStoreStatus() {
        const statusElement = document.getElementById('store-status');
        const now = new Date();
        const hour = now.getHours();
        if (hour >= 18 && hour <= 23) {
            statusElement.innerHTML = '<span class="dot dot-open"></span> Aberto agora';
        } else {
            statusElement.innerHTML = '<span class="dot dot-closed"></span> Fechado agora';
        }
    }

    function addToCart(name, price, image) {
        const item = cart.find(i => i.name === name);
        if (item) item.quantity++;
        else cart.push({ name, price, image, quantity: 1 });
        saveCart();
        updateUI();
    }

    function openFlavorModal(name, price, flavors, image) {
        currentFlavorProduct = { name, price, image };
        document.getElementById('flavor-title').innerText = name;
        const container = document.getElementById('flavor-options');
        container.innerHTML = flavors.map(f => `<button class="flavor-btn" onclick="addFlavorToCart('${f}')">${f}</button>`).join('');
        document.getElementById('flavor-modal').style.display = 'block';
    }

    function addFlavorToCart(flavor) {
        addToCart(`${currentFlavorProduct.name} (${flavor})`, currentFlavorProduct.price, currentFlavorProduct.image);
        closeModal('flavor-modal');
    }

    // APLICA√á√ÉO DE CUPONS
    function applyCoupon() {
        const input = document.getElementById('coupon-input').value.toUpperCase();
        const msg = document.getElementById('coupon-msg');
        activeDiscount = 0;
        freeShippingRequested = false;

        if (input === "FRETEGRATIS") {
            freeShippingRequested = true;
            msg.innerHTML = "<span style='color:green'>Cupom FRETEGRATIS ativado (V√°lido apenas para Delivery).</span>";
        } else if (input === "10%") {
            activeDiscount = 0.10;
            msg.innerHTML = "<span style='color:green'>Desconto de 10% aplicado!</span>";
        } else if (input === "5%") {
            activeDiscount = 0.05;
            msg.innerHTML = "<span style='color:green'>Desconto de 5% aplicado!</span>";
        } else {
            msg.innerHTML = "<span style='color:red'>Cupom inv√°lido.</span>";
        }
        updateUI();
    }

    function updateUI() {
        let subtotal = cart.reduce((acc, curr) => acc + (curr.price * curr.quantity), 0);
        let totalComDesconto = subtotal - (subtotal * activeDiscount);
        
        const type = document.getElementById('delivery-type')?.value;
        
        // Regra do FRETEGRATIS: s√≥ funciona se for 'delivery'
        if (type === 'delivery') {
            if (!freeShippingRequested) {
                totalComDesconto += 10; // Adiciona taxa normal
            }
        }

        document.getElementById('cart-footer').style.display = cart.length > 0 ? 'flex' : 'none';
        document.getElementById('cart-count').innerText = cart.reduce((a, b) => a + b.quantity, 0);
        document.getElementById('cart-total-display').innerText = totalComDesconto.toFixed(2);
        document.getElementById('modal-total').innerText = totalComDesconto.toFixed(2);
    }

    function renderCartItems() {
        document.getElementById('cart-items-list').innerHTML = cart.map(item => `
            <div class="cart-row">
                <img src="${item.image}" class="cart-img">
                <div style="flex:1; text-align: left;">
                    <strong>${item.name}</strong><br>
                    R$ ${(item.price * item.quantity).toFixed(2)}
                </div>
                <div class="qty-controls">
                    <button onclick="changeQuantity('${item.name}', -1)">-</button>
                    <span>${item.quantity}</span>
                    <button onclick="changeQuantity('${item.name}', 1)">+</button>
                </div>
                <button class="btn-remove" onclick="removeItem('${item.name}')">
                    <i class="fas fa-trash-alt"></i>
                </button>
            </div>`).join('');
    }

    function changeQuantity(name, delta) {
        const item = cart.find(i => i.name === name);
        if(item) {
            item.quantity += delta;
            if(item.quantity <= 0) cart = cart.filter(i => i.name !== name);
        }
        saveCart();
        updateUI(); 
        renderCartItems();
    }

    function removeItem(name) {
        cart = cart.filter(i => i.name !== name);
        saveCart();
        updateUI();
        renderCartItems();
    }

    function toggleFields() {
        const type = document.getElementById('delivery-type').value;
        document.getElementById('fields-mesa').style.display = type === 'mesa' ? 'block' : 'none';
        document.getElementById('fields-retirada').style.display = type === 'retirada' ? 'block' : 'none';
        document.getElementById('fields-delivery').style.display = type === 'delivery' ? 'block' : 'none';
        
        document.getElementById('delivery-warning').style.display = type === 'delivery' ? 'block' : 'none';
        updateUI();
    }

    function validarCPF(cpf) {
        cpf = cpf.replace(/[^\d]+/g,'');
        if(cpf == '') return false;
        if (cpf.length != 11 || cpf == "00000000000" || cpf == "11111111111" || cpf == "22222222222" || cpf == "33333333333" || cpf == "44444444444" || cpf == "55555555555" || cpf == "66666666666" || cpf == "77777777777" || cpf == "88888888888" || cpf == "99999999999") return false;
        let add = 0;
        for (let i=0; i < 9; i ++) add += parseInt(cpf.charAt(i)) * (10 - i);
        let rev = 11 - (add % 11);
        if (rev == 10 || rev == 11) rev = 0;
        if (rev != parseInt(cpf.charAt(9))) return false;
        add = 0;
        for (let i = 0; i < 10; i ++) add += parseInt(cpf.charAt(i)) * (11 - i);
        rev = 11 - (add % 11);
        if (rev == 10 || rev == 11) rev = 0;
        if (rev != parseInt(cpf.charAt(10))) return false;
        return true;
    }

    function sendWhatsApp() {
        const type = document.getElementById('delivery-type').value;
        const totalStr = document.getElementById('modal-total').innerText;
        
        if (type === 'delivery') {
            const cpfInput = document.getElementById('dev-CPF');
            if (!validarCPF(cpfInput.value)) {
                cpfInput.classList.add('input-error');
                alert("Por favor, insira um CPF v√°lido para o delivery.");
                return;
            }
            cpfInput.classList.remove('input-error');
        }

        currentPaymentLink = linksDePagamentoFixos[totalStr] || "#";
        const payBtn = document.getElementById('pay-link');
        payBtn.href = currentPaymentLink;
        payBtn.style.display = currentPaymentLink === "#" ? "none" : "block";

        document.getElementById('pay-total').innerText = totalStr;
        let produtosTxt = cart.map(i => `${i.quantity}x ${i.name}`).join(', ');
        
        let dadosParaPlanilha = {
            produtos: produtosTxt, total: totalStr, coleta: type,
            nome: "", cpf: "", bairro: "", rua: "", numero: "", comp: ""
        };

        if (type === 'mesa') {
            dadosParaPlanilha.nome = document.getElementById('mesa-nome').value;
        } else if (type === 'retirada') {
            dadosParaPlanilha.nome = document.getElementById('ret-nome').value;
            dadosParaPlanilha.cpf = document.getElementById('cpf-retirada').value;
        } else if (type === 'delivery') {
            dadosParaPlanilha.nome = document.getElementById('dev-nome').value;
            dadosParaPlanilha.cpf = document.getElementById('dev-CPF').value;
            dadosParaPlanilha.bairro = document.getElementById('dev-bairro').value;
            dadosParaPlanilha.rua = document.getElementById('dev-rua').value;
            dadosParaPlanilha.numero = document.getElementById('dev-num').value;
            dadosParaPlanilha.comp = document.getElementById('dev-comp').value;
        }

        enviarParaPlanilha(dadosParaPlanilha);
        document.getElementById('checkout-modal').style.display = 'none';
        document.getElementById('payment-modal').style.display = 'block';
    }

    function finalizarWhatsApp() {
        const type = document.getElementById('delivery-type').value;
        let msg = `*üêù NOVO PEDIDO - BEEDRINKS*\n\n`;
        
        if (type === 'mesa') {
            msg += `*Cliente:* ${document.getElementById('mesa-nome').value}\n*Local:* Mesa 5\n`;
        } else if (type === 'retirada') {
            msg += `*Cliente:* ${document.getElementById('ret-nome').value}\n*CPF:* ${document.getElementById('cpf-retirada').value}\n*Entrega:* Retirada no Balc√£o\n`;
        } else if (type === 'delivery') {
            msg += `*Cliente:* ${document.getElementById('dev-nome').value}\n*CPF:* ${document.getElementById('dev-CPF').value}\n*Endere√ßo:* ${document.getElementById('dev-rua').value}, ${document.getElementById('dev-num').value}\n*Bairro:* ${document.getElementById('dev-bairro').value}\n`;
            const complemento = document.getElementById('dev-comp').value;
            if (complemento) msg += `*Comp:* ${complemento}\n`;
            
            // Logica da taxa no texto do WhatsApp
            if (freeShippingRequested) {
                msg += `*Entrega:* Delivery (FRETE GR√ÅTIS APLICADO)\n`;
            } else {
                msg += `*Entrega:* Delivery (+ Taxa R$ 10,00)\n`;
            }
        }

        if (activeDiscount > 0) msg += `*Desconto Aplicado:* ${activeDiscount * 100}%\n`;

        msg += `\n*√çTENS DO PEDIDO:*\n`;
        cart.forEach(i => msg += `‚úÖ ${i.quantity}x ${i.name} (R$ ${(i.price * i.quantity).toFixed(2)})\n`);
        
        msg += `\n*TOTAL A PAGAR: R$ ${document.getElementById('pay-total').innerText}*`;
        
        if(currentPaymentLink !== "#") {
            msg += `\n\n*LINK DE PAGAMENTO:* \n${currentPaymentLink}`;
        }
        
        msg += `\n\n_Por favor, aguarde a confirma√ß√£o do pagamento._`;
        
        localStorage.removeItem('beeDrinksCart');
        cart = [];
        window.open(`https://wa.me/5562995679219?text=${encodeURIComponent(msg)}`);
        location.reload();
    }

    function filterCategory(cat) {
        document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
        if (event) event.target.classList.add('active');
        document.querySelectorAll('.menu-section').forEach(s => {
            s.style.display = (cat === 'all' || s.dataset.category === cat) ? 'block' : 'none';
        });
    }

    function mascaraCPF(i) {
        let v = i.value.replace(/\D/g,"");
        v = v.replace(/(\d{3})(\d)/,"$1.$2");
        v = v.replace(/(\d{3})(\d)/,"$1.$2");
        v = v.replace(/(\d{3})(\d{1,2})$/,"$1-$2");
        i.value = v;
    }

    function toggleCart() { const m = document.getElementById('cart-modal'); renderCartItems(); m.style.display = m.style.display === 'block' ? 'none' : 'block'; }
    function openCheckout() { document.getElementById('cart-modal').style.display = 'none'; document.getElementById('checkout-modal').style.display = 'block'; }
    function closeCheckout() { document.getElementById('checkout-modal').style.display = 'none'; document.getElementById('cart-modal').style.display = 'block'; }
    function closePayment() { document.getElementById('payment-modal').style.display = 'none'; document.getElementById('checkout-modal').style.display = 'block'; }
    function closeModal(id) { document.getElementById(id).style.display = 'none'; }

    function enviarParaPlanilha(dados) {
        const FORM_URL = "https://docs.google.com/forms/d/e/1FAIpQLScCadaja6iLfwVL7fH6aVs_iXTJpZgBREY-Ju98Zqg3KKslWg/formResponse";
        const formData = new FormData();
        formData.append("entry.62718261", dados.produtos);        
        formData.append("entry.1278482765", dados.nome);            
        formData.append("entry.143126943", dados.cpf);             
        formData.append("entry.1878038120", dados.bairro);           
        formData.append("entry.1399400806", dados.rua);                 
        formData.append("entry.764712754", dados.numero);           
        formData.append("entry.1697072560", dados.comp);        
        formData.append("entry.1857638858", dados.coleta);          
        formData.append("entry.1235511550", dados.total);            
        fetch(FORM_URL, { method: "POST", mode: "no-cors", body: formData });
    }
</script>
</body>
</html>
